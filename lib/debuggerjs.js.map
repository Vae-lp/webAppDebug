{"version":3,"sources":["../src/debuggerjs.js"],"names":["DebuggerInstance","error","instance","errLocation","create","sendErrorData","needShow","createWraper","createContent","me","Debugger","wraper","style","parseCSS","timeStamp","Date","alertBox","document","createElement","id","cssText","wrapCss","onclick","showWraper","hideWraper","body","appendChild","count","errorCount","content","contentCss","innerHTML","errNoCss","message","hrCss","locationCss","location","replace","setTimeout","blur","then","parentNode","removeChild","timer","Promise","res","rej","setInterval","opacity","getCssValue","clearTimeout","transform","webkitTransform","wrapHeight","parseFloat","needReport","url","method","errorObj","href","ua","navigator","userAgent","filename","getFileName","lineno","getLineNo","colno","getColNo","getLocation","data","target","attr","window","getComputedStyle","splitLocation","rs","exec","RE","RegExp","$1","$2","$3","locationObj","confData","init","options","addEventListener","listenScriptError","log","arguments","isError","getStackMessage","stack","getStackLocation","isEvent","throwError","src","e","isErrorEvent","isXHR","isString","isUndefined","Error","stackArr","split","length","constructor","Event","ErrorEvent","isProgressEvent","ProgressEvent","XMLHttpRequest","Object","prototype","toString","call"],"mappings":"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","file":"debuggerjs.js","sourcesContent":["/**\n * Created by didi on 16/9/21.\n */\nimport ajax from '@fdaciuk/ajax';\nimport objectAssign from 'object-assign';\n\nclass DebuggerInstance {\n    constructor(error) {\n        this.instance = null;\n        this.errLocation = {};\n        this.create(error);\n        this.sendErrorData(error);\n    }\n\n    create(error) {\n        if (!error.needShow) return;\n\n        this.createWraper();\n        this.createContent(error);\n    }\n\n    createWraper(){\n        let me = this;\n\n        if(!Debugger.wraper){\n            let style = me.parseCSS();\n            let timeStamp = +new Date();\n            let alertBox = document.createElement('div');\n            alertBox.id = 'debugger-' + timeStamp;\n            alertBox.style.cssText = style.wrapCss;\n            alertBox.onclick = function () {\n                Debugger.showWraper ? me.hideWraper() : me.showWraper();\n            };\n            Debugger.wraper = alertBox;\n\n            document.body.appendChild(alertBox);\n        }\n    }\n\n    createContent(error){\n        let me = this;\n        let style = me.parseCSS();\n        let count = Debugger.errorCount;\n\n        let content = document.createElement('div');\n        content.style.cssText = style.contentCss;\n        content.innerHTML = `\n            <p><span style=\"${style.errNoCss}\"> err${count}: </span> ${error.message}</p>\n            <div style=\"${style.hrCss}\"/></div>\n            <p><span style=\"${style.locationCss}\"> location: </span> ${error.location.replace(/(<anonymous>)|(<\\/anonymous>)/ig,'')}</p>\n            `;\n\n        me.instance = content;\n\n        Debugger.wraper.appendChild(content);\n\n        Debugger.errorCount++;\n\n        setTimeout(function () {\n            // me.destroy();\n        }, 10000)\n    }\n\n    destroy() {\n        let me = this;\n        me.blur()\n            .then(function () {\n                let instance = me.instance;\n                instance && instance.parentNode && instance.parentNode.removeChild(instance);\n            })\n    }\n\n    blur() {\n        let me = this,\n            instance = this.instance,\n            timer = null;\n\n        return new Promise(function (res, rej) {\n            timer = setInterval(function () {\n                let opacity = me.getCssValue(instance, 'opacity');\n                if (opacity < 0.1) {\n                    clearTimeout(timer);\n                    res()\n                } else {\n                    instance.style.opacity = opacity - 0.1\n                }\n            }, 50)\n        });\n\n    }\n\n    showWraper(){\n        if(!Debugger.wraper) return;\n        Debugger.wraper.style.transform = 'translateY(0px)';\n        Debugger.wraper.style.webkitTransform = 'translateY(0px)';\n        Debugger.showWraper = true;\n    }\n\n    hideWraper(){\n        if(!Debugger.wraper) return;\n        let me = this;\n        let wrapHeight = me.getCssValue(Debugger.wraper, 'height');\n        Debugger.wraper.style.transform = 'translateY(' + (parseFloat(wrapHeight) - 5) +'px)';\n        Debugger.wraper.style.webkitTransform = 'translateY(' + (parseFloat(wrapHeight) - 5) +'px)';\n        Debugger.showWraper = false;\n    }\n    sendErrorData(error) {\n        if (!error.needReport) return;\n\n        const url = error.url;\n        const method = error.method;\n\n        let errorObj = {\n            url: location.href,\n            ua: navigator.userAgent,\n            filename: error.filename || this.getFileName(error.location),\n            lineno: error.lineno || this.getLineNo(error.location),\n            colno: error.colno || this.getColNo(error.location),\n            message: error.message || '',\n            location: this.getLocation(error.location) || ''\n        };\n        ajax({\n            url: url,\n            method: method,\n            data: errorObj\n        })\n    }\n\n    parseCSS(){\n        let wrapCss, contentCss, errNoCss, locationCss, hrCss;\n        wrapCss = \"position: fixed; bottom:0; box-sizing:border-box; opacity: 1; word-wrap: break-word;word-break: break-all; transform: translateY(0px);-webkit-transform: translateY(0px);transition: transform 0.3s ease;-webkit-transition: -webkit-transform 0.3s ease;\";\n        contentCss = \"background: rgba(0, 0, 0, 0.6);color: #fff;line-height: 1.2;padding: 0.5rem;box-sizing:border-box; border-bottom: 1px solid #f0f0f0;\";\n        errNoCss = \"background: #bd362f; border-radius:4px; color:#fff; padding-left:0.2rem; margin-right:0.2rem\";\n        locationCss = \"background: #0074cc; border-radius:4px; color:#fff; padding-left:0.2rem; margin-right:0.2rem\";\n        hrCss = 'margin:0.2rem 0; border-bottom: 1px dashed #999;';\n        return {wrapCss, contentCss, errNoCss, locationCss, hrCss}\n    }\n    getCssValue(target, attr) {\n        return window.getComputedStyle(target)[attr]\n    }\n\n    getFileName(location) {\n        return this.errLocation.filename ? this.errLocation.filename : this.splitLocation(location).filename\n    }\n\n    getLineNo(location) {\n        return this.errLocation.lineno ? this.errLocation.lineno : this.splitLocation(location).lineno\n    }\n\n    getColNo(location) {\n        return this.errLocation.colno ? this.errLocation.colno : this.splitLocation(location).colno\n    }\n\n    getLocation(location) {\n        return location.replace(/\\s*(\\(.*\\))\\s*/, '')\n    }\n\n    splitLocation(location) {\n        const rs = /^.*\\((.*\\.js):(\\d*):(\\d*)\\)/.exec(location);\n        const RE = RegExp;\n        let [filename,lineno,colno] = [RE.$1, RE.$2, RE.$3];\n        this.locationObj = {filename, lineno, colno} // for cache\n        return this.locationObj\n    }\n}\nconst Debugger = {\n\n    wraper: null,\n\n    showWraper: true,\n\n    errorCount: 1,\n\n    confData: {\n        needShow: true,\n        needReport: false,\n        method: 'post',\n        url: ''\n    },\n\n    init(options) {\n        let me = this;\n\n        if (options) {\n            me.confData = objectAssign(me.confData, options)\n        }\n        window.addEventListener('load',function () {\n            me.listenScriptError();\n        })\n    },\n\n    listenScriptError(){\n        let me = this;\n        window.addEventListener('error', function () {\n            me.log(arguments[0])\n        });\n    },\n    log(error){\n\n        let me = this;\n\n        error = objectAssign(error, me.confData);\n\n        if (me.isError(error)) {\n\n            error.message = me.getStackMessage(error.stack);\n            error.location = me.getStackLocation(error.stack);\n            new DebuggerInstance(error);\n\n        } else if (me.isEvent(error)) {\n            me.throwError()\n                .then(e => {\n                    var target = error.target;\n                    error.message = \"Resource Error: can't get \" + (target.src || target.href) + \".\";\n                    error.location = me.getStackLocation(e.stack);\n                    new DebuggerInstance(error);\n                });\n\n\n        } else if (me.isErrorEvent(error)) {\n\n            error.location = me.getStackLocation(error.error.stack);\n            new DebuggerInstance(error);\n\n        } else if (me.isXHR(error)) {\n\n            me.throwError()\n                .then(e => {\n                    error.message = \"AJAX Error: XMLHttpRequest failed. Did you use $.ajax? the Debugger can't get more detail from error callback. Please check your $.ajax settings.\"\n                    error.location = me.getStackLocation(e.stack);\n                    new DebuggerInstance(error);\n\n                })\n\n        } else if (me.isString(error)) {\n            me.throwError()\n                .then(e => {\n                    new DebuggerInstance({\n                        message: error,\n                        location: me.getStackLocation(e.stack)\n                    });\n                })\n\n        } else if (me.isUndefined(error)) {\n            me.throwError()\n                .then(e => {\n                    error.message = \"Params Error: Debugger.log(...) must have 1 param in it, but found none\";\n                    error.location = me.getStackLocation(e.stack);\n                    new DebuggerInstance(error);\n\n                });\n        } else {\n            me.throwError()\n                .then(e => {\n                    error.message = \"Unknown Error.\";\n                    error.location = me.getStackLocation(e.stack);\n                    new DebuggerInstance(error);\n                });\n        }\n    },\n    throwError(){\n        return new Promise(function (res, rej) {\n            try {\n                throw new Error();\n            } catch (e) {\n                res(e)\n            }\n        })\n\n    },\n    getStackMessage(stack){\n        let stackArr = stack.split(/\\n+/);\n        return stackArr[0].replace(/(^\\s+|\\s+$)/, \"\");\n    },\n    getStackLocation(stack){\n        let stackArr = stack.split(/\\n+/);\n        return stackArr[stackArr.length - 1].replace(/(^\\s+|\\s+$)/, \"\");\n    },\n    isError(error){\n        return error instanceof Error;\n    },\n    isEvent(error){\n        return error.constructor === Event;\n    },\n    isErrorEvent(error){\n        return error.constructor === ErrorEvent;\n    },\n    isProgressEvent(error){\n        return error.constructor === ProgressEvent;\n    },\n    isXHR(error){\n        return error.constructor === XMLHttpRequest;\n    },\n    isString(error){\n        return Object.prototype.toString.call(error) === \"[object String]\"\n    },\n    isUndefined(error){\n        return Object.prototype.toString.call(error) === \"[object Undefined]\"\n    }\n\n};\nexport default Debugger;"]}